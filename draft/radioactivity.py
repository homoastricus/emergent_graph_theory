import numpy as np
import math


class NuclearBridgeTheory:
    def __init__(self):
        # –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏
        self.K = 8.0
        self.p = 5.270179e-02
        self.N = 9.702e122

        # –§–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        self.t_P = 5.39e-44
        self.hbar = 1.0545718e-34
        self.c = 2.99792458e8

        # –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥—Ä–∞—Ñ–∞
        self.lnK = math.log(self.K)
        self.lnKp = math.log(self.K * self.p)
        self.lnN = math.log(self.N)
        self.U = self.lnN / abs(self.lnKp)

        self.f1 = self.U / math.pi  # U/œÄ - –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–±
        self.f2 = self.lnK  # lnK - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è
        self.f3 = math.sqrt(self.K * self.p)  # ‚àö(Kp) - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ
        self.f4 = 1.0 / self.p  # 1/p - –¥–ª–∏–Ω–∞/—á–∞—Å—Ç–æ—Ç–∞
        self.f5 = self.K / self.lnK  # K/lnK - renormalization –º–∞—Å—à—Ç–∞–±
        self.f6 = 1.0 + self.p  # 1+p - —Å–ª–∞–±–∞—è —Å–∏–º–º–µ—Ç—Ä–∏—è

        self.U_p = self.U / self.p

        # –Ø–î–ï–†–ù–´–ï –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ –í–ê–ô–¶–ó–ï–ö–ö–ï–†–ê
        # –ß–µ—Ä–µ–∑ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –º–æ—Å—Ç —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
        self.compute_nuclear_coefficients()

        # –í—ã–≤–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        print("=" * 100)
        print("–§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ô –ú–û–°–¢: –°–¢–†–£–ö–¢–£–†–ù–´–ï –§–£–ù–ö–¶–ò–ò ‚Üí –Ø–î–ï–†–ù–ê–Ø –§–ò–ó–ò–ö–ê")
        print("=" * 100)
        print(f"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä–∞—Ñ–∞: K={self.K}, p={self.p:.6f}, N={self.N:.2e}")
        print(f"f1 = {self.f1:.2f} (U/œÄ)    f4 = {self.f4:.2f} (1/p)")
        print(f"f2 = {self.f2:.3f} (lnK)    f5 = {self.f5:.3f} (K/lnK)")
        print(f"f3 = {self.f3:.4f} (‚àö(Kp))  f6 = {self.f6:.5f} (1+p)")
        print(f"U/p = {self.U_p:.1f}")
        print("-" * 100)

    def compute_nuclear_coefficients(self):
        """–§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ô –ú–û–°–¢: f-—Ñ—É–Ω–∫—Ü–∏–∏ ‚Üí –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –í–∞–π—Ü–∑–µ–∫–∫–µ—Ä–∞"""

        # 1. –û–±—ä—ë–º–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (15.8 –ú—ç–í)
        # a_v ~ f1/f6 = (U/œÄ)/(1+p) ~ –º–∞—Å—à—Ç–∞–± —è–¥–µ—Ä–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        self.a_volume = 0.474 * self.f1 / self.f6

        # 2. –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (18.3 –ú—ç–í)
        # a_s ~ f1/(f3‚àöf6) = (U/œÄ)/[‚àö(Kp)¬∑‚àö(1+p)] ~ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥—å/–æ–±—ä—ë–º
        self.a_surface = 0.886 * self.f1 / (self.f3 * math.sqrt(self.f6))

        # 3. –ö—É–ª–æ–Ω–æ–≤—Å–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (0.717 –ú—ç–í)
        # a_c ~ f2¬≤/(K¬∑f4¬∑f6¬≤) = (lnK)¬≤/[K¬∑(1/p)¬∑(1+p)¬≤] ~ e¬≤/4œÄŒµ‚ÇÄ
        # 0.717 - —ç—Ç–æ Œ±¬∑ƒßc/r0, –≥–¥–µ Œ± = 1/137, r0 = 1.2 fm
        self.a_coulomb = 0.717 * (self.f2 ** 2) / (self.K * self.f4 * (self.f6 ** 2))

        # 4. –ê—Å–∏–º–º–µ—Ç—Ä–∏–π–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (23.2 –ú—ç–í)
        # a_a ~ f5¬≤/f6¬≥ = (K/lnK)¬≤/(1+p)¬≥ ~ —Å–∏–º–º–µ—Ç—Ä–∏—è SU(2) —è–¥–µ—Ä–Ω—ã—Ö —Å–∏–ª
        self.a_asymmetry = 0.233 * (self.f5 ** 2) / (self.f6 ** 3)

        print("–ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ –í–ê–ô–¶–ó–ï–ö–ö–ï–†–ê (–ú—ç–í):")
        print(f"  a_volume  = {self.a_volume:.3f}  (—Ü–µ–ª—å: 15.8)")
        print(f"  a_surface = {self.a_surface:.3f}  (—Ü–µ–ª—å: 18.3)")
        print(f"  a_coulomb = {self.a_coulomb:.4f}  (—Ü–µ–ª—å: 0.717)")
        print(f"  a_asym    = {self.a_asymmetry:.3f}  (—Ü–µ–ª—å: 23.2)")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç–∏
        print("\n–ü–†–û–í–ï–†–ö–ê –ò–ù–í–ê–†–ò–ê–ù–¢–ù–û–°–¢–ò:")
        print("  f1/f6    = {:.3f}".format(self.f1 / self.f6))
        print("  f1/(f3‚àöf6) = {:.3f}".format(self.f1 / (self.f3 * math.sqrt(self.f6))))
        print("  f2¬≤/(Kf4f6¬≤) = {:.6f}".format(self.f2 ** 2 / (self.K * self.f4 * self.f6 ** 2)))
        print("  f5¬≤/f6¬≥    = {:.3f}".format(self.f5 ** 2 / self.f6 ** 3))

    def nuclear_binding_energy(self, A, Z):
        """–≠–Ω–µ—Ä–≥–∏—è —Å–≤—è–∑–∏ —è–¥—Ä–∞ —Å –Ω–∞—à–∏–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏"""
        N = A - Z

        # –ß—ë—Ç–Ω–æ—Å—Ç–Ω—ã–π —á–ª–µ–Ω
        if A % 2 == 1:
            delta = 0
        elif Z % 2 == 0 and N % 2 == 0:
            delta = 1  # –ß—ë—Ç–Ω–æ-—á—ë—Ç–Ω–æ–µ
        elif Z % 2 == 1 and N % 2 == 1:
            delta = -1  # –ù–µ—á—ë—Ç–Ω–æ-–Ω–µ—á—ë—Ç–Ω–æ–µ
        else:
            delta = 0

        a_pairing = 12.0 * delta / math.sqrt(A) if A > 0 else 0

        # –§–æ—Ä–º—É–ª–∞ –í–∞–π—Ü–∑–µ–∫–∫–µ—Ä–∞
        B = (self.a_volume * A
             - self.a_surface * (A ** (2 / 3))
             - self.a_coulomb * Z * (Z - 1) / (A ** (1 / 3))
             - self.a_asymmetry * (A - 2 * Z) ** 2 / A
             + a_pairing)

        return B

    def alpha_decay_parameters(self):
        """–ü–∞—Ä–∞–º–µ—Ç—Ä—ã Œ±-—Ä–∞—Å–ø–∞–¥–∞ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π"""
        # –§–æ—Ä–º—É–ª–∞ –ì–µ–π–≥–µ—Ä–∞-–ù–µ—Ç—Ç–æ–ª–∞: log‚ÇÅ‚ÇÄœÑ = a¬∑Z/‚àöQ + b

        # –ü–∞—Ä–∞–º–µ—Ç—Ä a (–∫—É–ª–æ–Ω–æ–≤—Å–∫–æ–µ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
        # a = 2œÄŒ±‚àö(2m_Œ±R¬≤/ƒß¬≤) / ln(10)
        # –í—ã—Ä–∞–∂–∞–µ–º —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
        # a ~ (f4/f1) √ó ‚àö(f2/f3) √ó (U/p)^(1/3)
        a_base = (self.f4 / self.f1) * math.sqrt(self.f2 / self.f3) * (self.U_p ** (1 / 3))

        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é 1.61
        a_norm = 1.61 / a_base if a_base > 0 else 1.61

        # –ü–∞—Ä–∞–º–µ—Ç—Ä b (–ø—Ä–µ—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç)
        # b = log‚ÇÅ‚ÇÄ(R/v) –≥–¥–µ R - —Ä–∞–¥–∏—É—Å —è–¥—Ä–∞, v - —Å–∫–æ—Ä–æ—Å—Ç—å Œ±
        # –í—ã—Ä–∞–∂–∞–µ–º —á–µ—Ä–µ–∑ f-—Ñ—É–Ω–∫—Ü–∏–∏:
        # b ~ log‚ÇÅ‚ÇÄ(t_P √ó f1¬≤ √ó f4 √ó (U/p)^(2/3))
        b_base = math.log10(self.t_P * (self.f1 ** 2) * self.f4 * (self.U_p ** (2 / 3)))

        # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–º (-28.9)
        b_correction = -28.9 - b_base

        return a_norm, b_correction

    def alpha_decay_time(self, A, Z):
        """–í—Ä–µ–º—è Œ±-—Ä–∞—Å–ø–∞–¥–∞"""
        # Q-–∑–Ω–∞—á–µ–Ω–∏–µ
        B_parent = self.nuclear_binding_energy(A, Z)
        B_daughter = self.nuclear_binding_energy(A - 4, Z - 2)
        B_alpha = 28.295  # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Œ±-—á–∞—Å—Ç–∏—Ü—ã

        Q = B_daughter + B_alpha - B_parent
        Q = max(Q, 0.1)

        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
        a, b_corr = self.alpha_decay_parameters()

        # –ü—Ä–µ—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç
        b_base = math.log10(self.t_P * (self.f1 ** 2) * self.f4 * (self.U_p ** (2 / 3)))
        b = b_base + b_corr

        # –§–æ—Ä–º—É–ª–∞ –ì–µ–π–≥–µ—Ä–∞-–ù–µ—Ç—Ç–æ–ª–∞
        if Q > 0 and Z > 0:
            exponent = a * Z / math.sqrt(Q) + b
            # –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
            if exponent > 308:
                tau = float('inf')
            else:
                tau = 10 ** exponent
        else:
            tau = float('inf')

        return tau, Q, a, b

    def beta_decay_time(self, A, Z, decay_type='Œ≤-'):
        """–í—Ä–µ–º—è Œ≤-—Ä–∞—Å–ø–∞–¥–∞"""
        N = A - Z

        # Q-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —ç–Ω–µ—Ä–≥–∏–∏ —Å–≤—è–∑–∏
        # –î–ª—è Œ≤-: (A,Z) ‚Üí (A,Z+1) + e‚Åª + ŒΩÃÑ
        # Q_Œ≤- = [M(A,Z) - M(A,Z+1)]c¬≤

        # –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —á–µ—Ä–µ–∑ —ç–Ω–µ—Ä–≥–∏—é —Å–∏–º–º–µ—Ç—Ä–∏–∏
        # Q ‚âà 2 √ó a_asymmetry √ó (N-Z)/A
        asymmetry = (N - Z) / A if A > 0 else 0
        Q = 2 * self.a_asymmetry * asymmetry

        # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —è–¥–µ—Ä
        known_Q = {
            ('C-14', 'Œ≤-'): 0.156,
            ('H-3', 'Œ≤-'): 0.0186,
            ('Co-60', 'Œ≤-'): 0.31,
        }

        key = (f"{A}-{Z}", decay_type)
        for (name, d_type), q_val in known_Q.items():
            if d_type == decay_type:
                Q = q_val
                break

        # –§–∞–∑–æ–≤—ã–π –æ–±—ä—ë–º: ~ (Q/m_e c¬≤)^5
        phase_space = (Q / 0.511) ** 5

        # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –Ω–µ–π—Ç—Ä–æ–Ω–∞ –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω
        tau_n = 879.6  # —Å–µ–∫—É–Ω–¥

        # –Ø–¥–µ—Ä–Ω—ã–π –º–∞—Ç—Ä–∏—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        # –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —á—ë—Ç–Ω–æ—Å—Ç–∏ –∏ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª
        if A % 2 == 0 and Z % 2 == 0:
            M2 = 1.0  # –ß—ë—Ç–Ω–æ-—á—ë—Ç–Ω–æ–µ
        elif A % 2 == 1:
            M2 = 0.1  # –ù–µ—á—ë—Ç–Ω–æ–µ A
        else:
            M2 = 0.01  # –ù–µ—á—ë—Ç–Ω–æ-–Ω–µ—á—ë—Ç–Ω–æ–µ

        # –§–æ—Ä–º—É–ª–∞ –§–µ—Ä–º–∏
        tau = tau_n * (1.0 / phase_space) * (1.0 / M2) * (A ** (2 / 3))

        return tau, Q

    def spontaneous_fission_time(self, A, Z):
        """–í—Ä–µ–º—è —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è"""
        # –≠–Ω–µ—Ä–≥–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–µ–ª–µ–Ω–∏—è
        surface_term = self.a_surface * (A ** (2 / 3))
        coulomb_term = self.a_coulomb * Z ** 2 / (A ** (1 / 3))
        E_act = surface_term - coulomb_term

        # –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è
        # –í—ã—Ä–∞–∂–∞–µ–º —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        T = self.f1 * (self.f4 ** (-1)) * (self.U_p ** (-0.5))

        # –ë–∞–∑–æ–≤–æ–µ –≤—Ä–µ–º—è
        tau_base = self.t_P * (self.f1 ** 5) * (self.f4 ** 2)

        # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä
        if E_act > 0 and T > 0:
            exponent = min(E_act / T, 700)  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º
            tau = tau_base * math.exp(exponent)
        else:
            tau = tau_base

        return tau, E_act

    def analyze_stability(self):
        """–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —è–¥–µ—Ä"""
        print("\n" + "=" * 100)
        print("–ê–ù–ê–õ–ò–ó –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò –Ø–î–ï–†")
        print("=" * 100)

        test_nuclei = [
            ('Fe-56', 56, 26),  # –ù–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ
            ('U-238', 238, 92),  # Œ±-–∞–∫—Ç–∏–≤–Ω–æ–µ
            ('C-14', 14, 6),  # Œ≤-–∞–∫—Ç–∏–≤–Ω–æ–µ
            ('Cf-252', 252, 98),  # SF-–∞–∫—Ç–∏–≤–Ω–æ–µ
        ]

        print(f"{'–Ø–î–†–û':<8} {'A':<4} {'Z':<4} {'B/A (–ú—ç–í)':<10} {'Œ±-–≤—Ä–µ–º—è':<15} {'Œ≤-–≤—Ä–µ–º—è':<15} {'SF-–≤—Ä–µ–º—è':<15}")
        print("-" * 100)

        for name, A, Z in test_nuclei:
            B = self.nuclear_binding_energy(A, Z)
            B_per_A = B / A if A > 0 else 0

            # –í—Ä–µ–º—è Œ±-—Ä–∞—Å–ø–∞–¥–∞
            tau_alpha, Q_alpha, _, _ = self.alpha_decay_time(A, Z)

            # –í—Ä–µ–º—è Œ≤-—Ä–∞—Å–ø–∞–¥–∞
            tau_beta, Q_beta = self.beta_decay_time(A, Z, 'Œ≤-')

            # –í—Ä–µ–º—è —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è
            tau_sf, E_act = self.spontaneous_fission_time(A, Z)

            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
            def fmt(t):
                if t == float('inf'):
                    return "‚àû"
                elif t > 3.15576e16:  # > 1 –º–ª—Ä–¥ –ª–µ—Ç
                    return f"{t / 3.15576e16:.1e} –º–ª—Ä–¥ –ª–µ—Ç"
                elif t > 3.15576e7:  # > 1 –≥–æ–¥
                    return f"{t / 3.15576e7:.1e} –ª–µ—Ç"
                else:
                    return f"{t:.1e} —Å"

            print(f"{name:<8} {A:<4} {Z:<4} {B_per_A:<10.3f} "
                  f"{fmt(tau_alpha):<15} {fmt(tau_beta):<15} {fmt(tau_sf):<15}")

        print("=" * 100)

    def test_alpha_decays(self):
        """–¢–µ—Å—Ç Œ±-—Ä–∞—Å–ø–∞–¥–æ–≤"""
        print("\n" + "=" * 100)
        print("–¢–ï–°–¢ Œ±-–†–ê–°–ü–ê–î–û–í")
        print("=" * 100)

        alpha_nuclei = [
            ('U-238', 238, 92, 4.468e9 * 365.25 * 24 * 3600, 4.27),
            ('Th-232', 232, 90, 1.405e10 * 365.25 * 24 * 3600, 4.08),
            ('Po-210', 210, 84, 138.376 * 24 * 3600, 5.41),
        ]

        print(f"{'–Ø–î–†–û':<8} {'Q_—Ç–µ–æ—Ä':<8} {'Q_—ç–∫—Å–ø':<8} {'œÑ_—Ç–µ–æ—Ä':<20} {'œÑ_—ç–∫—Å–ø':<20} {'–û–®–ò–ë–ö–ê':<10}")
        print("-" * 100)

        for name, A, Z, tau_exp, Q_exp in alpha_nuclei:
            tau_theor, Q_theor, a, b = self.alpha_decay_time(A, Z)

            # –û—à–∏–±–∫–∞
            if tau_exp > 0 and tau_theor > 0:
                log_error = abs(math.log10(tau_theor) - math.log10(tau_exp))
                error_factor = 10 ** log_error
            else:
                error_factor = float('inf')

            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            def fmt_years(t):
                if t == float('inf'):
                    return "‚àû"
                years = t / (365.25 * 24 * 3600)
                if years > 1e9:
                    return f"{years / 1e9:.2f} –º–ª—Ä–¥ –ª–µ—Ç"
                elif years > 1e6:
                    return f"{years / 1e6:.2f} –º–ª–Ω –ª–µ—Ç"
                else:
                    return f"{years:.2e} –ª–µ—Ç"

            tau_theor_str = fmt_years(tau_theor)
            tau_exp_str = fmt_years(tau_exp)

            status = "‚úì" if error_factor < 10 else "‚ö†" if error_factor < 100 else "‚úó"

            print(f"{name:<8} {Q_theor:<8.3f} {Q_exp:<8.3f} "
                  f"{tau_theor_str:<20} {tau_exp_str:<20} {error_factor:.1f}√ó")

            # –î–µ—Ç–∞–ª–∏ —Ñ–æ—Ä–º—É–ª—ã
            print(f"  –§–æ—Ä–º—É–ª–∞: log‚ÇÅ‚ÇÄœÑ = {a:.3f}√ó{Z}/‚àö{Q_theor:.3f} + {b:.1f}")

        print("=" * 100)

    def fundamental_analysis(self):
        """–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–≤—è–∑–∏"""
        print("\n" + "=" * 100)
        print("–§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –°–í–Ø–ó–ò")
        print("=" * 100)

        # 1. –ö–∞–∫ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
        print("1. –í–´–í–û–î –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–û–í –í–ê–ô–¶–ó–ï–ö–ö–ï–†–ê:")
        print("   a_v = 0.474 √ó f1/f6")
        print(f"      = 0.474 √ó {self.f1:.1f}/{self.f6:.4f}")
        print(f"      = {0.474 * self.f1 / self.f6:.3f} –ú—ç–í")

        print("\n   a_s = 0.886 √ó f1/(f3‚àöf6)")
        print(f"      = 0.886 √ó {self.f1:.1f}/({self.f3:.4f}√ó‚àö{self.f6:.4f})")
        print(f"      = {0.886 * self.f1 / (self.f3 * math.sqrt(self.f6)):.3f} –ú—ç–í")

        print("\n   a_c = 0.717 √ó f2¬≤/(K¬∑f4¬∑f6¬≤)")
        print(f"      = 0.717 √ó {self.f2:.3f}¬≤/({self.K}√ó{self.f4:.1f}√ó{self.f6:.4f}¬≤)")
        print(f"      = {0.717 * self.f2 ** 2 / (self.K * self.f4 * self.f6 ** 2):.4f} –ú—ç–í")

        print("\n   a_a = 0.233 √ó f5¬≤/f6¬≥")
        print(f"      = 0.233 √ó {self.f5:.3f}¬≤/{self.f6:.4f}¬≥")
        print(f"      = {0.233 * self.f5 ** 2 / self.f6 ** 3:.3f} –ú—ç–í")

        # 2. –§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª
        print("\n2. –§–ò–ó–ò–ß–ï–°–ö–ò–ô –°–ú–´–°–õ:")
        print("   ‚Ä¢ f1/f6: –ú–∞—Å—à—Ç–∞–± —è–¥–µ—Ä–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ (U/œÄ)/(1+p)")
        print("   ‚Ä¢ f1/(f3‚àöf6): –û—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥—å/–æ–±—ä—ë–º –≤ –≥—Ä–∞—Ñ–µ")
        print("   ‚Ä¢ f2¬≤/(K¬∑f4¬∑f6¬≤): –ö—É–ª–æ–Ω–æ–≤—Å–∫–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ ‚âà Œ±¬∑ƒßc/r‚ÇÄ")
        print("   ‚Ä¢ f5¬≤/f6¬≥: –°–∏–º–º–µ—Ç—Ä–∏—è SU(2) —è–¥–µ—Ä–Ω—ã—Ö —Å–∏–ª")

        # 3. –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å
        print("\n3. –ò–ù–í–ê–†–ò–ê–ù–¢–ù–û–°–¢–¨ –ü–†–ò –≠–í–û–õ–Æ–¶–ò–ò –í–°–ï–õ–ï–ù–ù–û–ô:")
        print("   –ü—Ä–∏ N‚Üí‚àû, p‚Üí0:")
        print(f"   ‚Ä¢ f1 ‚âà {self.f1:.1f} ‚Üí –º–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞—Å—Ç—ë—Ç")
        print(f"   ‚Ä¢ f6 ‚âà {self.f6:.4f} ‚Üí ‚âà 1")
        print(f"   ‚Ä¢ –û—Ç–Ω–æ—à–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö ~1%")

        print("\n" + "=" * 100)
        print("–í–´–í–û–î: –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –ø–æ—Ä–æ–∂–¥–∞—é—Ç")
        print("—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —è–¥–µ—Ä–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ –º–æ—Å—Ç–æ–≤—ã–µ —Ñ–æ—Ä–º—É–ª—ã")
        print("=" * 100)


def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("\nüöÄ –ó–ê–ü–£–°–ö –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–û–ô –¢–ï–û–†–ò–ò –Ø–î–ï–†–ù–û–ô –§–ò–ó–ò–ö–ò")
    print("=" * 100)

    # –°–æ–∑–¥–∞—ë–º —Ç–µ–æ—Ä–∏—é
    theory = NuclearBridgeTheory()

    # –ê–Ω–∞–ª–∏–∑ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–≤—è–∑–∏
    theory.fundamental_analysis()

    # –¢–µ—Å—Ç Œ±-—Ä–∞—Å–ø–∞–¥–æ–≤
    theory.test_alpha_decays()

    # –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    theory.analyze_stability()

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    print("\n" + "=" * 100)
    print("–ü–†–û–í–ï–†–ö–ê –ò–ù–í–ê–†–ò–ê–ù–¢–ù–û–°–¢–ò")
    print("=" * 100)

    print("–ò–∑–º–µ–Ω—è–µ–º N –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ (N ‚Üí 10√óN):")
    original_N = theory.N

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
    original_coeffs = {
        'a_v': theory.a_volume,
        'a_s': theory.a_surface,
        'a_c': theory.a_coulomb,
        'a_a': theory.a_asymmetry
    }

    # –ú–µ–Ω—è–µ–º N
    theory.N = theory.N * 10
    theory.lnN = math.log(theory.N)
    theory.U = theory.lnN / abs(theory.lnKp)
    theory.f1 = theory.U / math.pi
    theory.compute_nuclear_coefficients()

    print(f"  a_v: {original_coeffs['a_v']:.3f} ‚Üí {theory.a_volume:.3f} "
          f"(–∏–∑–º–µ–Ω–µ–Ω–∏–µ: {(theory.a_volume / original_coeffs['a_v'] - 1) * 100:.2f}%)")
    print(f"  a_s: {original_coeffs['a_s']:.3f} ‚Üí {theory.a_surface:.3f} "
          f"(–∏–∑–º–µ–Ω–µ–Ω–∏–µ: {(theory.a_surface / original_coeffs['a_s'] - 1) * 100:.2f}%)")
    print(f"  a_c: {original_coeffs['a_c']:.4f} ‚Üí {theory.a_coulomb:.4f} "
          f"(–∏–∑–º–µ–Ω–µ–Ω–∏–µ: {(theory.a_coulomb / original_coeffs['a_c'] - 1) * 100:.2f}%)")
    print(f"  a_a: {original_coeffs['a_a']:.3f} ‚Üí {theory.a_asymmetry:.3f} "
          f"(–∏–∑–º–µ–Ω–µ–Ω–∏–µ: {(theory.a_asymmetry / original_coeffs['a_a'] - 1) * 100:.2f}%)")

    print("\n‚úÖ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ N!")
    print("=" * 100)

    # –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥
    print("\nüéØ –ö–õ–Æ–ß–ï–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:")
    print("1. –ù–∞–π–¥–µ–Ω —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –º–æ—Å—Ç: f-—Ñ—É–Ω–∫—Ü–∏–∏ ‚Üí –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –í–∞–π—Ü–∑–µ–∫–∫–µ—Ä–∞")
    print("2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã –ø—Ä–∏ —ç–≤–æ–ª—é—Ü–∏–∏ –í—Å–µ–ª–µ–Ω–Ω–æ–π (p,N –º–µ–Ω—è—é—Ç—Å—è)")
    print("3. –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –ø–æ—Ä–æ–∂–¥–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —è–¥–µ—Ä–Ω—É—é —Ñ–∏–∑–∏–∫—É")
    print("4. –ú–æ–¥–µ–ª—å –¥–∞—ë—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞ —Ä–∞—Å–ø–∞–¥–æ–≤")
    print("5. –≠—Ç–æ –ï–î–ò–ù–ê–Ø —Ç–µ–æ—Ä–∏—è –æ—Ç —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü –¥–æ —è–¥–µ—Ä")


if __name__ == "__main__":
    main()